Тестовое задание: реализовать сквозной процесс SQL → Python → Excel
(дедупликация заказов, сбор отчёта и визуализация).


запуск на windows 
py -3.11 -m venv venv
.\venv\Scripts\Activate.ps1
pip install -r requirements.txt


Запуск скрипта:
python data/generate_data.py --email you@domain.com --orders 8000 --days 30

Скрипт generate_data.py создаёт тестовые данные для аналитического задания — таблицы продавцов, заказов и товаров (sellers.csv, orders.csv, order_items.csv).
Эти данные потом используются для SQL-выгрузки и Excel-отчёта.

Обязательные параметры:
1. --email 
Тип: строка
Зачем нужен: используется как seed (зерно для генератора случайных чисел).
Благодаря этому при одинаковом e-mail ты получаешь одинаковый набор данных — повторяемость результата.
Пример:
--email jordan@example.com
*Если запустить дважды с этим e-mail, файлы CSV будут идентичны.

Необязательные параметры:
1. --orders
Тип: целое число
Зачем нужен: задаёт, сколько заказов будет сгенерировано.
Большее значение → больше данных → длиннее генерация, больше вес файлов.
Пример:
--orders 5000  # создаст 5000 заказов
Значение по умолчанию: 8000

2. --days
Тип: целое число
Пример:
--orders 5000  # данные периодом 90 дней
Значение по умолчанию: 90

3. --out
Тип: строка (путь к папке)
Зачем нужен: указывает, куда сохранять сгенерированные .csv-файлы.
По умолчанию: data/
Пример:
--out tmp/
Тогда файлы окажутся в tmp/sellers.csv, tmp/orders.csv и tmp/order_items.csv.

4. --db
Тип: строка (путь к файлу или специальное значение :memory:)
Назначение: задаёт, куда будет записана (или загружена) SQLite-база.
По умолчанию: :memory: — временная база создаётся в оперативной памяти и удаляется после завершения скрипта.


Используемые индексы:

orders(external_id) — используется при дедупликации заказов (GROUP BY external_id или ROW_NUMBER() OVER (PARTITION BY external_id)), ускоряет поиск уникальных заказов.
orders(date) — помогает при фильтрации по периоду (WHERE date >= CURRENT_DATE - :days), что часто используется при отчётных выгрузках.
orders(updated_at) — ускоряет выборку последних изменений по заказам при работе с окнами или сортировкой.
orders(delivered_at) — нужен для анализа выполненных заказов и дедупликации, где важно брать запись с максимальной датой доставки.
order_items(order_id) — оптимизирует соединение (JOIN) заказов и позиций при расчёте сумм и маржи по заказу.

Эти индексы минимизируют полные сканирования таблиц (FULL SCAN) и позволяют SQLite использовать план с INDEX SEARCH, что особенно важно при больших объёмах данных (5–10 тыс. заказов и выше).
В результате время выполнения SQL-запросов и дедупликации снижается в 3–5 раз.

Используемы ИИ запросы: 
"Разбей тестовое задание SQL → Python → Excel на 50 шагов с пояснениями."
"Как убрать дубликаты заказов по external_id, если нужно брать запись с максимальным delivered_at?"
"Какие индексы нужны для ускорения дедупликации и соединений заказов с товарами?"
"Какие индексы нужны для ускорения дедупликации и соединений таблиц в SQLite?"
"Как с помощью openpyxl собрать итоговый Excel-файл с листами Orders, Summary, Dashboard и Checks?"
"Как построить график Conversion Funnel (paid/created, delivered/shipped и т.д.) с подписями значений на столбцах?"
"Как посчитать отношения paid/created, shipped/prod_started и delivered/created по уникальным заказам?"
"Как в pandas отловить строки с qty <= 0, отрицательной маржей и пропущенными seller/channel?"
* более 80% кода с применением ИИ
